<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Commerce Platform - Home</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        body {
            background: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* Header styles */
        .main-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 80px 0;
        }
        
        .navbar {
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        /* Admin dashboard button styling */
        .nav-link[href="/admin/dashboard"] {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            border-radius: 5px;
            margin: 0 5px;
            transition: all 0.3s ease;
        }
        
        .nav-link[href="/admin/dashboard"]:hover {
            background: linear-gradient(45deg, #e55a2b, #e08419);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(255, 107, 53, 0.3);
        }
        
        /* Admin dashboard button in profile section */
        .btn-outline-danger[href="/admin/dashboard"] {
            background: linear-gradient(45deg, #dc3545, #c82333);
            border: none;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-outline-danger[href="/admin/dashboard"]:hover {
            background: linear-gradient(45deg, #c82333, #bd2130);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.4);
            color: white;
        }
        
        /* Card styles */
        .feature-card, .stat-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            border: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            height: 100%;
        }
        
        .feature-card:hover, .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .stat-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        /* Profile section styles */
        .profile-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5rem;
            margin: 0 auto 20px;
        }
        
        .profile-info-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .profile-info-label {
            font-weight: 600;
            color: #495057;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .profile-info-value {
            color: #212529;
            font-size: 1.1rem;
        }
        
        /* Form styles */
        .form-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        /* Password input group */
        .password-input-group {
            position: relative;
        }
        
        .password-toggle {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            border: none;
            background: none;
            color: #6c757d;
            cursor: pointer;
        }
        
        /* Action buttons */
        .action-btn {
            border-radius: 10px;
            padding: 12px 25px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
        }
        
        /* Role badge */
        .role-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-shopping-cart me-2"></i>E-Commerce Platform
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="/">
                            <i class="fas fa-home me-1"></i>Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" th:href="@{/products/allproducts}">
                            <i class="fas fa-store me-1"></i>Products
                        </a>
                    </li>
                    <!-- Admin Dashboard Button - Only visible to ADMIN users -->
                    <li class="nav-item" sec:authorize="hasRole('ADMIN')">
                        <a class="nav-link" href="/admin/dashboard">
                            <i class="fas fa-cogs me-1"></i>Admin Dashboard
                        </a>
                    </li>
                    <li class="nav-item" sec:authorize="isAuthenticated()">
                        <a class="nav-link" href="#dashboard">
                            <i class="fas fa-tachometer-alt me-1"></i>Dashboard
                        </a>
                    </li>
                    <li class="nav-item" sec:authorize="isAuthenticated()">
                        <a class="nav-link" href="#profile">
                            <i class="fas fa-user me-1"></i>Profile
                        </a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <!-- Guest navigation -->
                    <li class="nav-item" sec:authorize="!isAuthenticated()">
                        <a class="nav-link" href="/login">
                            <i class="fas fa-sign-in-alt me-1"></i>Login
                        </a>
                    </li>
                    <li class="nav-item" sec:authorize="!isAuthenticated()">
                        <a class="nav-link" href="/register">
                            <i class="fas fa-user-plus me-1"></i>Register
                        </a>
                    </li>
                    
                    <!-- Authenticated user navigation -->
                    <li class="nav-item dropdown" sec:authorize="isAuthenticated()">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user me-1"></i><span sec:authentication="name">User</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#profile">
                                <i class="fas fa-user-circle me-2"></i>My Profile
                            </a></li>
                            <li><a class="dropdown-item" href="#profile">
                                <i class="fas fa-edit me-2"></i>Edit Profile
                            </a></li>
                            <li><a class="dropdown-item" href="#profile">
                                <i class="fas fa-key me-2"></i>Change Password
                            </a></li>
                            <!-- Admin Dashboard in dropdown - Only visible to ADMIN users -->
                            <li sec:authorize="hasRole('ADMIN')"><hr class="dropdown-divider"></li>
                            <li sec:authorize="hasRole('ADMIN')">
                                <a class="dropdown-item" href="/admin/dashboard">
                                    <i class="fas fa-cogs me-2"></i>Admin Dashboard
                                </a>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="/logout">
                                <i class="fas fa-sign-out-alt me-2"></i>Logout
                            </a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Header -->
    <section class="main-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <div sec:authorize="!isAuthenticated()">
                        <h1 class="display-4 fw-bold mb-3">Welcome to E-Commerce Platform</h1>
                        <p class="lead mb-4">Discover amazing products and enjoy seamless shopping experience</p>
                        <div>
                            <a href="/register" class="btn btn-light btn-lg me-3">
                                <i class="fas fa-user-plus me-2"></i>Get Started
                            </a>
                            <a href="/login" class="btn btn-outline-light btn-lg">
                                <i class="fas fa-sign-in-alt me-2"></i>Login
                            </a>
                        </div>
                    </div>
                    
                    <div sec:authorize="isAuthenticated()">
                        <h1 class="display-4 fw-bold mb-3">
                            Welcome back, <span sec:authentication="name">User</span>!
                        </h1>
                        <p class="lead mb-4">Ready to continue your shopping journey?</p>
                        <a href="#dashboard" class="btn btn-light btn-lg">
                            <i class="fas fa-arrow-down me-2"></i>View Dashboard
                        </a>
                    </div>
                </div>
                <div class="col-lg-4 text-center">
                    <div sec:authorize="isAuthenticated()">
                        <div class="profile-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <h4 class="text-white" sec:authentication="name">User</h4>
                        <span class="role-badge bg-light text-dark" sec:authorize="hasRole('ADMIN')">Administrator</span>
                        <span class="role-badge bg-light text-dark" sec:authorize="hasRole('CUSTOMER')">Customer</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Success/Error Messages -->
    <div class="container pt-4" sec:authorize="isAuthenticated()">
        <div th:if="${message}" class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="fas fa-check-circle me-2"></i>
            <span th:text="${message}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>

        <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="fas fa-exclamation-circle me-2"></i>
            <span th:text="${error}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container py-5">
        <!-- Public Features Section (for non-authenticated users) -->
        <section sec:authorize="!isAuthenticated()">
            <div class="row mb-5">
                <div class="col-12 text-center mb-5">
                    <h2 class="fw-bold">Why Choose Our Platform?</h2>
                    <p class="text-muted">Experience the best in online shopping</p>
                </div>
            </div>
            
            <div class="row g-4 mb-5">
                <div class="col-md-3">
                    <div class="feature-card text-center">
                        <i class="fas fa-shopping-cart stat-icon text-primary"></i>
                        <h5 class="fw-bold">Easy Shopping</h5>
                        <p class="text-muted">Browse and shop with our intuitive interface</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="feature-card text-center">
                        <i class="fas fa-shield-alt stat-icon text-success"></i>
                        <h5 class="fw-bold">Secure Payments</h5>
                        <p class="text-muted">Your transactions are safe and secure</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="feature-card text-center">
                        <i class="fas fa-truck stat-icon text-warning"></i>
                        <h5 class="fw-bold">Fast Delivery</h5>
                        <p class="text-muted">Quick and reliable shipping to your door</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="feature-card text-center">
                        <a href="/products" class="text-decoration-none">
                            <i class="fas fa-store stat-icon text-info"></i>
                            <h5 class="fw-bold text-dark">Browse Products</h5>
                            <p class="text-muted">Explore our amazing catalog</p>
                            <div class="mt-3">
                                <button class="btn btn-info action-btn text-white">
                                    <i class="fas fa-arrow-right me-2"></i>Shop Now
                                </button>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- User Dashboard Section (for authenticated users) -->
        <section id="dashboard" sec:authorize="isAuthenticated()">
            <div class="row mb-5">
                <div class="col-12 text-center mb-5">
                    <h2 class="fw-bold">Your Dashboard</h2>
                    <p class="text-muted">Manage your account and track your activities</p>
                </div>
            </div>
            
            <div class="row g-4 mb-5">
                <div class="col-md-4">
                    <div class="stat-card text-center">
                        <a href="/customer/viewcart" class="text-decoration-none">
                            <i class="fas fa-shopping-cart stat-icon text-primary"></i>
                            <h5 class="fw-bold text-dark mt-3">View Cart</h5>
                            <p class="text-muted mb-0">Check your cart items</p>
                            <div class="mt-3">
                                <button class="btn btn-primary action-btn">
                                    <i class="fas fa-arrow-right me-2"></i>View Cart
                                </button>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stat-card text-center">
                        <a href="/customer/my-orders" class="text-decoration-none">
                            <i class="fas fa-box stat-icon text-success"></i>
                            <h5 class="fw-bold text-dark mt-3">My Orders</h5>
                            <p class="text-muted mb-0">Track your orders</p>
                            <div class="mt-3">
                                <button class="btn btn-success action-btn">
                                    <i class="fas fa-arrow-right me-2"></i>View Orders
                                </button>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stat-card text-center">
                        <a href="#" class="text-decoration-none" th:href="@{/products/allproducts}">
                            <i class="fas fa-store stat-icon text-warning"></i>
                            <h5 class="fw-bold text-dark mt-3">Shop Products</h5>
                            <p class="text-muted mb-0">Browse our catalog</p>
                            <div class="mt-3">
                                <button class="btn btn-warning action-btn">
                                    <i class="fas fa-arrow-right me-2"></i>View Products
                                </button>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- User Profile Section -->
        <section id="profile" sec:authorize="isAuthenticated()" th:if="${user != null}">
            <div class="row">
                <div class="col-12 mb-4">
                    <h2 class="fw-bold text-center">My Profile</h2>
                </div>
            </div>
            
            <div class="row g-4">
                <div class="col-lg-4">
                    <div class="profile-section text-center">
                        <div class="profile-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <h4 class="fw-bold" th:text="${user.username}">Username</h4>
                        <span class="role-badge bg-success text-white" th:if="${user.role.name() == 'CUSTOMER'}" th:text="${user.role}">CUSTOMER</span>
                        <span class="role-badge bg-danger text-white" th:if="${user.role.name() == 'ADMIN'}" th:text="${user.role}">ADMIN</span>
                        
                        <div class="d-grid gap-2 mt-4">
                            <button class="btn btn-primary" onclick="showEditProfile()">
                                <i class="fas fa-edit me-2"></i>Edit Profile
                            </button>
                            <button class="btn btn-outline-warning" onclick="showChangePassword()">
                                <i class="fas fa-key me-2"></i>Change Password
                            </button>
                            <!-- Admin Dashboard Button - Only visible to ADMIN users -->
                            <a sec:authorize="hasRole('ADMIN')" href="/admin/dashboard" class="btn btn-outline-danger">
                                <i class="fas fa-cogs me-2"></i>Admin Dashboard
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-8">
                    <div class="profile-section">
                        <h5 class="fw-bold mb-4">
                            <i class="fas fa-info-circle me-2 text-primary"></i>Profile Information
                        </h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="profile-info-item">
                                    <div class="profile-info-label">
                                        <i class="fas fa-id-badge me-2"></i>User ID
                                    </div>
                                    <div class="profile-info-value" th:text="${user.userId}">#12345</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="profile-info-item">
                                    <div class="profile-info-label">
                                        <i class="fas fa-user me-2"></i>Username
                                    </div>
                                    <div class="profile-info-value" th:text="${user.username}">Username</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="profile-info-item">
                                    <div class="profile-info-label">
                                        <i class="fas fa-envelope me-2"></i>Email
                                    </div>
                                    <div class="profile-info-value" th:text="${user.email}">email@example.com</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="profile-info-item">
                                    <div class="profile-info-label">
                                        <i class="fas fa-shield-alt me-2"></i>Role
                                    </div>
                                    <div class="profile-info-value" th:text="${user.role}">CUSTOMER</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Edit Profile Form -->
        <section id="edit-profile" sec:authorize="isAuthenticated()" th:if="${user != null}" style="display: none;">
            <div class="row">
                <div class="col-12 mb-4">
                    <h2 class="fw-bold text-center">Edit Profile</h2>
                </div>
            </div>
            
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="form-section">
                        <form th:action="@{/user/{userId}(userId=${user.userId})}" th:object="${user}" method="post">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="username" class="form-label">
                                        <i class="fas fa-user me-2"></i>Username
                                    </label>
                                    <input type="text" class="form-control" id="username" th:field="*{username}" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="email" class="form-label">
                                        <i class="fas fa-envelope me-2"></i>Email
                                    </label>
                                    <input type="email" class="form-control" id="email" th:field="*{email}" required>
                                </div>
                            </div>
                            
                            <div class="d-flex gap-3">
                                <button type="submit" class="btn btn-success action-btn">
                                    <i class="fas fa-save me-2"></i>Save Changes
                                </button>
                                <button type="button" class="btn btn-outline-secondary action-btn" onclick="hideEditProfile()">
                                    <i class="fas fa-times me-2"></i>Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- Change Password Form -->
        <section id="change-password" sec:authorize="isAuthenticated()" th:if="${user != null}" style="display: none;">
            <div class="row">
                <div class="col-12 mb-4">
                    <h2 class="fw-bold text-center">Change Password</h2>
                </div>
            </div>
            
            <div class="row justify-content-center">
                <div class="col-lg-6">
                    <div class="form-section">
                        <form th:action="@{/user/{userId}/change-password(userId=${user.userId})}" method="post">
                            <div class="mb-3">
                                <label for="currentPassword" class="form-label">
                                    <i class="fas fa-lock me-2"></i>Current Password
                                </label>
                                <div class="password-input-group">
                                    <input type="password" class="form-control" id="currentPassword" name="currentPassword" required>
                                    <button type="button" class="password-toggle" onclick="togglePassword('currentPassword', this)">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="newPassword" class="form-label">
                                    <i class="fas fa-key me-2"></i>New Password
                                </label>
                                <div class="password-input-group">
                                    <input type="password" class="form-control" id="newPassword" name="newPassword" required minlength="6">
                                    <button type="button" class="password-toggle" onclick="togglePassword('newPassword', this)">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="mb-4">
                                <label for="confirmPassword" class="form-label">
                                    <i class="fas fa-check-double me-2"></i>Confirm New Password
                                </label>
                                <div class="password-input-group">
                                    <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" required minlength="6">
                                    <button type="button" class="password-toggle" onclick="togglePassword('confirmPassword', this)">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="d-flex gap-3">
                                <button type="submit" class="btn btn-warning action-btn">
                                    <i class="fas fa-key me-2"></i>Change Password
                                </button>
                                <button type="button" class="btn btn-outline-secondary action-btn" onclick="hideChangePassword()">
                                    <i class="fas fa-times me-2"></i>Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4 mt-5">
        <div class="container text-center">
            <p class="mb-0">E-Commerce Platform. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function showEditProfile() {
            document.getElementById('profile').style.display = 'none';
            document.getElementById('edit-profile').style.display = 'block';
            document.getElementById('edit-profile').scrollIntoView({behavior: 'smooth'});
        }

        function hideEditProfile() {
            document.getElementById('edit-profile').style.display = 'none';
            document.getElementById('profile').style.display = 'block';
            document.getElementById('profile').scrollIntoView({behavior: 'smooth'});
        }

        function showChangePassword() {
            document.getElementById('profile').style.display = 'none';
            document.getElementById('change-password').style.display = 'block';
            document.getElementById('change-password').scrollIntoView({behavior: 'smooth'});
        }

        function hideChangePassword() {
            document.getElementById('change-password').style.display = 'none';
            document.getElementById('profile').style.display = 'block';
            document.getElementById('profile').scrollIntoView({behavior: 'smooth'});
        }

        function togglePassword(inputId, button) {
            const input = document.getElementById(inputId);
            const icon = button.querySelector('i');
            
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }

        // Password matching validation
        document.getElementById('confirmPassword')?.addEventListener('input', function() {
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = this.value;
            
            if (newPassword !== confirmPassword) {
                this.setCustomValidity('Passwords do not match');
                this.classList.add('is-invalid');
            } else {
                this.setCustomValidity('');
                this.classList.remove('is-invalid');
                this.classList.add('is-valid');
            }
        });
    </script>
>>>>>>> branch 'master' of https://github.com/Cognizant-Learning/AD004GobalEcommerce.git
</body>
</html>
